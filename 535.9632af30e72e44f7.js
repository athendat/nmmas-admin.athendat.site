"use strict";(self.webpackChunknmmas_admin_ssr=self.webpackChunknmmas_admin_ssr||[]).push([[535],{1608:(O,x,a)=>{a.d(x,{L:()=>d});var e=a(3953),t=a(1583),h=a(6582);let d=(()=>{class u{constructor(){this.store=(0,e.WQX)(h.il),this.router=(0,e.WQX)(t.Ix)}canActivate(C,v){const f=this.store.selectSnapshot(E=>E.account).permissions?.map(E=>E?.name),g=C.data?.permission;return!!(!g||!Array.isArray(g)&&f?.includes(g)||Array.isArray(g)&&g?.length&&g.every(E=>f?.includes(E)))||(this.router.navigate(["/error/403"]),!1)}static#e=this.\u0275fac=function(v){return new(v||u)};static#t=this.\u0275prov=e.jDH({token:u,factory:u.\u0275fac,providedIn:"root"})}return u})()},1228:(O,x,a)=>{a.d(x,{b:()=>U});var e=a(3953),t=a(177),h=a(9417),d=a(152),u=a(9172),M=a(5558),C=a(7673),v=a(6354),f=a(4310),g=a(5194),E=a(9079),R=a(3391),B=a(765),A=a(4370),j=a(7008),F=a(9542),G=a(9949),W=a(3955);const y=["deleteModal"],o=(s,I)=>I.id;function D(s,I){1&s&&(e.j41(0,"div",15),e.nrm(1,"app-loader",16),e.k0s()),2&s&&(e.R7$(),e.Y8G("loaderClass","custom-loader-wrapper"))}function n(s,I){if(1&s){const i=e.RV6();e.j41(0,"div",25)(1,"a",26),e.nrm(2,"i",27),e.k0s(),e.j41(3,"ul",28)(4,"a",29),e.bIt("click",function(){e.eBV(i);const c=e.XpG(2).$implicit,p=e.XpG(3);return e.Njj(p.DeleteModal.openModal("delete",c))}),e.nrm(5,"i",30),e.EFF(6),e.nI1(7,"translate"),e.k0s()()()}2&s&&(e.R7$(6),e.SpI(" ",e.bMT(7,1,"delete")," "))}function l(s,I){if(1&s&&(e.qex(0),e.DNE(1,n,8,3,"div",24),e.bVm()),2&s){const i=e.XpG(4);e.R7$(),e.Y8G("ngIf",i.deleteAction)}}function r(s,I){if(1&s){const i=e.RV6();e.j41(0,"div")(1,"div",18)(2,"input",19),e.bIt("change",function(c){const p=e.eBV(i).$implicit,P=e.XpG(3);return e.Njj(P.selectImage(c,p,P.url))}),e.k0s(),e.j41(3,"label",20)(4,"div",21),e.nrm(5,"img",22),e.k0s()(),e.DNE(6,l,2,1,"ng-container",23),e.k0s()()}if(2&s){const i=I.$implicit,_=e.XpG(3);e.R7$(2),e.FS9("type",_.multiple?"checkbox":"radio"),e.Mz_("id","attachment-",null==i?null:i.id,""),e.Y8G("value",null==i?null:i.id),e.R7$(),e.Mz_("for","attachment-",null==i?null:i.id,""),e.R7$(2),e.Y8G("src",i.original_url,e.B4B),e.R7$(),e.Y8G("hasPermission","attachment.destroy")}}function m(s,I){if(1&s&&(e.j41(0,"div",17),e.Z7z(1,r,7,8,"div",null,o),e.k0s()),2&s){const i=e.XpG(2);e.R7$(),e.Dyx(i.attachmentsStore.attachments())}}function T(s,I){if(1&s&&e.DNE(0,m,3,0,"div",17),2&s){const i=e.XpG();e.vxM(i.attachmentsStore.attachments().length?0:-1)}}function $(s,I){if(1&s){const i=e.RV6();e.j41(0,"nav",31)(1,"app-pagination",32),e.bIt("setPage",function(c){e.eBV(i);const p=e.XpG();return e.Njj(p.setPaginate(c))}),e.k0s()()}if(2&s){const i=e.XpG();e.R7$(),e.Y8G("total",i.totalItems)("currentPage",i.filter.page)("pageSize",i.filter.paginate)}}function L(s,I){1&s&&e.nrm(0,"app-no-data",13),2&s&&e.Y8G("image","assets/svg/no-media.svg")("text","No Media Found")}let U=(()=>{class s{constructor(){this.selectedImages=[],this.multiple=!1,this.url=!1,this.loading=!1,this.deleteAction=!0,this.setImage=new e.bkB,this.setDeleteImage=new e.bkB,this.term=new h.MJ,this.filter={search:"",field:"createdAt",sort:"",page:1,paginate:48},this.totalItems=0,this.attachmentsStore=(0,e.WQX)(g.uF),this.#e=(0,e.WQX)(t.qQ),this.#t=(0,e.WQX)(e.sFG),this.#n=(0,e.WQX)(f.VZ),this.#a=(0,e.WQX)(e.gRc),this.#i=(0,e.WQX)(e.abz),this.#s=(0,e.WQX)(f.JE)}#e;#t;#n;#a;#i;#s;ngOnInit(){this.term.valueChanges.pipe((0,E.pQ)(this.#i),(0,d.B)(300),(0,u.Z)(null),(0,M.n)(i=>null!==i?(this.loading=!0,this.#n.findAttachments({search:i,page:1,size:48,sort:"createdAt",order:"desc"})):(0,C.of)()),(0,v.T)(()=>{this.loading=!1,this.#t.addClass(this.#e.body,"loader-none")})).subscribe()}ngOnDestroy(){this.#t.removeClass(this.#e.body,"loader-none")}getAttachments(i,_){this.loading=!0,_||this.#t.addClass(this.#e.body,"loader-none")}onMediaChange(i){this.filter.sort=i.target.value,this.getAttachments(this.filter)}onActionClicked(i,_){"delete"===i&&this.#n.removeAttachments([_.id]).pipe((0,E.pQ)(this.#i)).subscribe(c=>{this.#s.showSuccess(c.message),this.#a.markForCheck()})}selectImage(i,_,c){if(this.multiple){const p=this.selectedImages.indexOf(_);i.target.checked?-1===p&&this.selectedImages.push(_):this.selectedImages=this.selectedImages.filter(P=>P.id!=i.target.value)}else this.selectedImages=_;c&&(this.selectedImages=_),this.setImage.emit(this.selectedImages)}setPaginate(i){this.filter.page=i,this.getAttachments(this.filter)}static#o=this.\u0275fac=function(_){return new(_||s)};static#l=this.\u0275cmp=e.VBU({type:s,selectors:[["app-media-box"]],viewQuery:function(_,c){if(1&_&&e.GBs(y,5),2&_){let p;e.mGM(p=e.lsd())&&(c.DeleteModal=p.first)}},inputs:{selectedImages:"selectedImages",multiple:"multiple",url:"url",loading:"loading",deleteAction:"deleteAction"},outputs:{setImage:"setImage",setDeleteImage:"setDeleteImage"},decls:28,vars:23,consts:[["mediaContent",""],["deleteModal",""],[1,"select-top-panel"],["type","text",1,"form-control",3,"placeholder","formControl"],[1,"form-select",3,"change"],["value",""],["value","newest"],["value","oldest"],["value","smallest"],["value","largest"],[1,"content-section","select-file-section","py-0","ratio2_3","custom-box-loader"],["class","box-loader",4,"ngIf","ngIfElse"],["class","custom-pagination",4,"ngIf"],[3,"image","text"],[3,"deleteItem"],[1,"box-loader"],[3,"loaderClass"],[1,"row","row-cols-xxl-6","row-cols-xl-5","row-cols-lg-4","row-cols-sm-3","row-cols-2","g-sm-3","g-2","media-library-sec","ratio_square"],[1,"library-box"],["name","attachment",1,"media-checkbox",3,"change","type","value","id"],[3,"for"],[1,"ratio","ratio-1x1"],["alt","attachment",1,"img-fluid",3,"src"],[4,"hasPermission"],["ngbDropdown","","class","dropdown",4,"ngIf"],["ngbDropdown","",1,"dropdown"],["href","javascript:void(0)","ngbDropdownToggle",""],[1,"ri-more-fill"],["ngbDropdownMenu","",1,"dropdown-menu","dropdown-menu-end"],["ngbDropdownItem","",1,"d-flex","align-items-center",3,"click"],[1,"ri-delete-bin-line","me-2"],[1,"custom-pagination"],[3,"setPage","total","currentPage","pageSize"]],template:function(_,c){if(1&_){const p=e.RV6();e.j41(0,"div",2)(1,"div"),e.nrm(2,"input",3),e.nI1(3,"translate"),e.k0s(),e.j41(4,"select",4),e.bIt("change",function(b){return e.eBV(p),e.Njj(c.onMediaChange(b))}),e.j41(5,"option",5),e.EFF(6),e.nI1(7,"translate"),e.k0s(),e.j41(8,"option",6),e.EFF(9),e.nI1(10,"translate"),e.k0s(),e.j41(11,"option",7),e.EFF(12),e.nI1(13,"translate"),e.k0s(),e.j41(14,"option",8),e.EFF(15),e.nI1(16,"translate"),e.k0s(),e.j41(17,"option",9),e.EFF(18),e.nI1(19,"translate"),e.k0s()()(),e.j41(20,"div",10),e.DNE(21,D,2,1,"div",11)(22,T,1,1,"ng-template",null,0,e.C5r)(24,$,2,3,"nav",12)(25,L,1,2,"app-no-data",13),e.k0s(),e.j41(26,"app-delete-modal",14,1),e.bIt("deleteItem",function(b){return e.eBV(p),e.Njj(c.onActionClicked(b.actionToPerform,b.data))}),e.k0s()}if(2&_){const p=e.sdS(23);e.R7$(2),e.FS9("placeholder",e.bMT(3,11,"search_your_files")),e.Y8G("formControl",c.term),e.R7$(4),e.JRh(e.bMT(7,13,"sort_by_desc")),e.R7$(3),e.JRh(e.bMT(10,15,"sort_by_newest")),e.R7$(3),e.JRh(e.bMT(13,17,"sort_by_oldest")),e.R7$(3),e.JRh(e.bMT(16,19,"sort_by_smallest")),e.R7$(3),e.JRh(e.bMT(19,21,"sort_by_largest")),e.R7$(3),e.Y8G("ngIf",c.loading)("ngIfElse",p),e.R7$(3),e.Y8G("ngIf",c.attachmentsStore.attachments()),e.R7$(),e.vxM(c.attachmentsStore.attachments().length?-1:25)}},dependencies:[t.bT,h.xH,h.y7,h.me,h.BC,h.l_,R.tg,R.do,R.U0,R._H,B.V,A.e,j.F,F.w,G.p,W.D9],encapsulation:2,changeDetection:0})}return s})()},9422:(O,x,a)=>{a.d(x,{X:()=>y});var e=a(467),t=a(3953),h=a(9079),d=a(3391),u=a(4310),M=a(177),C=a(8696),v=a(1228),f=a(7506),g=a(9949),E=a(3955);const R=["mediaModal"];function B(o,D){if(1&o){const n=t.RV6();t.j41(0,"app-media-box",17),t.bIt("setImage",function(r){t.eBV(n);const m=t.XpG(3);return t.Njj(m.setImage(r))}),t.k0s()}if(2&o){const n=t.XpG(3);t.Y8G("multiple",n.multipleImage())("url",n.url())("deleteAction",!1)}}function A(o,D){1&o&&(t.j41(0,"li",14)(1,"a",15),t.EFF(2),t.nI1(3,"translate"),t.k0s(),t.DNE(4,B,1,3,"ng-template",16),t.k0s()),2&o&&(t.Y8G("ngbNavItem","select"),t.R7$(2),t.JRh(t.bMT(3,2,"select_file")))}function j(o,D){if(1&o){const n=t.RV6();t.j41(0,"ngx-dropzone-image-preview",20),t.bIt("removed",function(){const r=t.eBV(n).$implicit,m=t.XpG(4);return t.Njj(m.onRemove(r))}),t.j41(1,"ngx-dropzone-label"),t.EFF(2),t.k0s()()}if(2&o){const n=D.$implicit;t.Y8G("file",n)("removable",!0),t.R7$(2),t.Lme("",n.name," (",n.type,")")}}function F(o,D){if(1&o){const n=t.RV6();t.j41(0,"div",18),t.bIt("change",function(r){t.eBV(n);const m=t.XpG(3);return t.Njj(m.onSelect(r))}),t.j41(1,"ngx-dropzone-label")(2,"div")(3,"h2"),t.EFF(4),t.nI1(5,"translate"),t.k0s()()(),t.DNE(6,j,3,4,"ngx-dropzone-image-preview",19),t.k0s()}if(2&o){const n=t.XpG(3);t.Y8G("accept","image/*"),t.R7$(4),t.JRh(t.bMT(5,3,"drop_files_here")),t.R7$(2),t.Y8G("ngForOf",n.files)}}function G(o,D){1&o&&(t.j41(0,"li",14)(1,"a",15),t.EFF(2),t.nI1(3,"translate"),t.k0s(),t.DNE(4,F,7,5,"ng-template",16),t.k0s()),2&o&&(t.Y8G("ngbNavItem","upload"),t.R7$(2),t.JRh(t.bMT(3,2,"upload_new")))}function W(o,D){if(1&o){const n=t.RV6();t.j41(0,"div",2)(1,"h2"),t.EFF(2),t.nI1(3,"translate"),t.k0s(),t.j41(4,"app-button",3),t.bIt("click",function(){const r=t.eBV(n).$implicit;return t.Njj(r.dismiss("Cross click"))}),t.nrm(5,"i",4),t.k0s()(),t.j41(6,"div",5)(7,"ul",6,1),t.mxI("activeIdChange",function(r){t.eBV(n);const m=t.XpG();return t.DH7(m.active,r)||(m.active=r),t.Njj(r)}),t.DNE(9,A,5,4,"li",7)(10,G,5,4,"li",8),t.k0s(),t.nrm(11,"div",9),t.k0s(),t.j41(12,"div",10),t.nrm(13,"div",11),t.j41(14,"div",12)(15,"app-button",13),t.bIt("click",function(){const r=t.eBV(n).$implicit,m=t.sdS(8),T=t.XpG();return t.Njj("upload"===T.active?T.addMedia(m):T.selectedMedia(r))}),t.EFF(16),t.nI1(17,"translate"),t.k0s()()()}if(2&o){const n=t.sdS(8),l=t.XpG();t.R7$(2),t.JRh(t.bMT(3,13,"insert_media")),t.R7$(2),t.HbH("btn btn-close"),t.Y8G("spinner",!1)("id","media_close_btn"),t.R7$(3),t.R50("activeId",l.active),t.R7$(2),t.Y8G("ngIf",l.selectMedia),t.R7$(),t.Y8G("hasPermission","attachment.create"),t.R7$(),t.Y8G("ngbNavOutlet",n),t.R7$(4),t.HbH("align-items-center btn btn-theme d-flex"),t.Y8G("id","media_btn"),t.R7$(),t.SpI(" ",t.bMT(17,15,"insert_media")," ")}}let y=(()=>{class o{constructor(){this.active="select",this.files=[],this.modalOpen=!1,this.multipleImage=(0,t.hFB)(!1),this.selectImage=(0,t.CGW)(),this.selectMedia=(0,t.hFB)(!0),this.url=(0,t.hFB)(!1),this.#e=(0,t.WQX)(u.VZ),this.#t=(0,t.WQX)(t.abz),this.#n=(0,t.WQX)(u.JE),this.#a=(0,t.WQX)(d.Bq)}#e;#t;#n;#a;ngOnDestroy(){this.modalOpen&&this.#a.dismissAll()}openModal(){var n=this;return(0,e.A)(function*(){n.modalOpen=!0,n.active=n.selectMedia?"select":"upload",n.#a.open(n.MediaModal,{ariaLabelledBy:"Media-Modal",centered:!0,windowClass:"theme-modal modal-xl media-modal"}).result.then(l=>{n.closeResult=`Closed with: ${l}`},l=>{n.closeResult=`Dismissed ${n.getDismissReason(l)}`})})()}getDismissReason(n){return this.active=this.selectMedia?"select":"upload",n===d.PQ.ESC?"by pressing ESC":n===d.PQ.BACKDROP_CLICK?"by clicking on a backdrop":`with: ${n}`}onSelect(n){this.files.length+n.addedFiles.length<=5?this.files.push(...n.addedFiles):this.#n.showError("You've reached 5 file maximum.")}onRemove(n){this.files.splice(this.files.indexOf(n),1)}addMedia(n){this.files.length&&"upload"===this.active&&this.#e.uploadAttachments(this.files).pipe((0,h.pQ)(this.#t)).subscribe(l=>{this.#n.showSuccess(l.message),this.files=[],this.selectMedia?n.select("select"):this.#a.dismissAll()})}setImage(n){this.media=n}selectedMedia(n){this.selectImage.emit(this.media),n.dismiss("close")}static#i=this.\u0275fac=function(l){return new(l||o)};static#s=this.\u0275cmp=t.VBU({type:o,selectors:[["app-media-modal"]],viewQuery:function(l,r){if(1&l&&t.GBs(R,5),2&l){let m;t.mGM(m=t.lsd())&&(r.MediaModal=m.first)}},inputs:{multipleImage:[1,"multipleImage"],selectMedia:[1,"selectMedia"],url:[1,"url"]},outputs:{selectImage:"selectImage"},decls:2,vars:0,consts:[["mediaModal",""],["nav","ngbNav"],[1,"modal-header"],[3,"click","spinner","id"],[1,"ri-close-line"],[1,"modal-body"],["ngbNav","",1,"nav-tabs",3,"activeIdChange","activeId"],[3,"ngbNavItem",4,"ngIf"],[3,"ngbNavItem",4,"hasPermission"],[1,"mt-2",3,"ngbNavOutlet"],[1,"modal-footer"],[1,"left-part"],[1,"right-part"],[3,"click","id"],[3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[3,"setImage","multiple","url","deleteAction"],["ngx-dropzone","",1,"content-section","drop-files-sec",3,"change","accept"],["ngProjectAs","ngx-dropzone-preview",5,["ngx-dropzone-preview"],3,"file","removable","removed",4,"ngFor","ngForOf"],["ngProjectAs","ngx-dropzone-preview",5,["ngx-dropzone-preview"],3,"removed","file","removable"]],template:function(l,r){1&l&&t.DNE(0,W,18,17,"ng-template",null,0,t.C5r)},dependencies:[M.Sq,M.bT,d.Um,d.X9,d.sy,d.Gx,d.Ri,d.WA,d.m_,C.s3,C.Gt,C.bB,v.b,f.Q,g.p,E.D9],encapsulation:2,changeDetection:0})}return o})()},7008:(O,x,a)=>{a.d(x,{F:()=>u});var e=a(3953),t=a(177),h=a(3955);function d(M,C){if(1&M&&e.nrm(0,"img",1),2&M){const v=e.XpG();e.Y8G("src",v.image,e.B4B)}}let u=(()=>{class M{constructor(){this.class="no-data-added"}static#e=this.\u0275fac=function(f){return new(f||M)};static#t=this.\u0275cmp=e.VBU({type:M,selectors:[["app-no-data"]],inputs:{class:"class",image:"image",text:"text"},decls:5,vars:6,consts:[["class","img-fluid","alt","no-data",3,"src",4,"ngIf"],["alt","no-data",1,"img-fluid",3,"src"]],template:function(f,g){1&f&&(e.j41(0,"div"),e.DNE(1,d,1,1,"img",0),e.j41(2,"h4"),e.EFF(3),e.nI1(4,"translate"),e.k0s()()),2&f&&(e.HbH(g.class),e.R7$(),e.Y8G("ngIf",g.image),e.R7$(2),e.JRh(e.bMT(4,4,g.text)))},dependencies:[t.bT,h.D9]})}return M})()}}]);