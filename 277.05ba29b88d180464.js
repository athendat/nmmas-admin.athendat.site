"use strict";(self.webpackChunknmmas_admin_ssr=self.webpackChunknmmas_admin_ssr||[]).push([[277],{1277:(j,y,s)=>{s.r(y),s.d(y,{RefundModule:()=>E});var f=s(177),r=s(6582),g=s(1583),d=s(1635),t=s(3953),b=s(8141);let p=(()=>{class o{static#t=this.type="[Refund] Get";constructor(n){this.payload=n}}return o})(),h=(()=>{class o{static#t=this.type="[Refund] Put";constructor(n,a){this.id=n,this.status=a}}return o})();var C=s(1626),i=s(5312);let u=(()=>{class o{constructor(){this.http=(0,t.WQX)(C.Qq)}getRefunds(n){return this.http.get(`${i.c.URL}/refund.json`,{params:n})}static#t=this.\u0275fac=function(a){return new(a||o)};static#a=this.\u0275prov=t.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var S=s(8701);let c=class R{constructor(){this.store=(0,t.WQX)(r.il),this.notificationService=(0,t.WQX)(S.J),this.refundService=(0,t.WQX)(u)}static refund(e){return e.refund}getRefund(e,n){return this.refundService.getRefunds(n.payload).pipe((0,b.M)({next:a=>{e.patchState({refund:{data:a.data,total:a?.total?a?.total:a.data?.length}})},error:a=>{throw new Error(a?.error?.message)}}))}updateRefundStatus(e,{}){}static#t=this.\u0275fac=function(n){return new(n||R)};static#a=this.\u0275prov=t.jDH({token:R,factory:R.\u0275fac})};(0,d.Cg)([(0,r.rc)(p)],c.prototype,"getRefund",null),(0,d.Cg)([(0,r.rc)(h)],c.prototype,"updateRefundStatus",null),(0,d.Cg)([(0,r.MD)()],c,"refund",null),c=(0,d.Cg)([(0,r.Uw)({name:"refund",defaults:{refund:{data:[],total:0}}})],c);var A=s(844),F=s(7313),P=s(6904);const D=["payoutModal"];class m{constructor(){this.store=(0,t.WQX)(r.il),this.tableConfig={columns:[{title:"No.",dataField:"no",type:"no"},{title:"order_number",dataField:"order_id"},{title:"consumer_name",dataField:"consumer_name",sortable:!0,sort_direction:"desc"},{title:"status",dataField:"refund_status"},{title:"created_at",dataField:"created_at",type:"date",sortable:!0,sort_direction:"desc"}],rowActions:[{label:"View",actionToPerform:"view",icon:"ri-eye-line"}],data:[],total:0}}ngOnInit(){this.refund$.subscribe(e=>{let n=e?.data?.filter(a=>(a.consumer_name=a?.user?.name,a.order_id=`<span class="fw-bolder">#${a?.order?.order_number}</span>`,a.refund_status=a.status?`<div class="status-${a.status}"><span>${a.status.replace(/_/g," ")}</span></div>`:"-",a));this.tableConfig.data=e?n:[],this.tableConfig.total=e?e?.total:0})}onActionClicked(e){"view"===e.actionToPerform&&this.PayoutModal.openModal(e.data)}onTableChange(e){this.store.dispatch(new p(e))}approved(e){this.store.dispatch(new h(e.data.id,e.status))}static#t=this.\u0275fac=function(n){return new(n||m)};static#a=this.\u0275cmp=t.VBU({type:m,selectors:[["app-refund"]],viewQuery:function(n,a){if(1&n&&t.GBs(D,5),2&n){let l;t.mGM(l=t.lsd())&&(a.PayoutModal=l.first)}},decls:4,vars:5,consts:[["payoutModal",""],[3,"gridClass","title"],[3,"tableChanged","action","tableConfig"],[3,"payout","label","action"]],template:function(n,a){if(1&n){const l=t.RV6();t.j41(0,"app-page-wrapper",1)(1,"app-table",2),t.bIt("tableChanged",function(v){return t.eBV(l),t.Njj(a.onTableChange(v))})("action",function(v){return t.eBV(l),t.Njj(a.onActionClicked(v))}),t.k0s()(),t.j41(2,"app-payout-modal",3,0),t.bIt("payout",function(v){return t.eBV(l),t.Njj(a.approved(v))}),t.k0s()}2&n&&(t.Y8G("gridClass","col-sm-12")("title","refund"),t.R7$(),t.Y8G("tableConfig",a.tableConfig),t.R7$(),t.Y8G("label","refund")("action",!1))},dependencies:[A.O,F.k,P.$]})}(0,d.Cg)([(0,r.l6)(c.refund)],m.prototype,"refund$",void 0);var G=s(1608);const I=[{path:"",component:m,canActivate:[G.L],data:{permission:"refund.index"}}];let T=(()=>{class o{static#t=this.\u0275fac=function(a){return new(a||o)};static#a=this.\u0275mod=t.$C({type:o});static#e=this.\u0275inj=t.G2t({imports:[g.iI.forChild(I),g.iI]})}return o})();var $=s(3887);let E=(()=>{class o{static#t=this.\u0275fac=function(a){return new(a||o)};static#a=this.\u0275mod=t.$C({type:o});static#e=this.\u0275inj=t.G2t({imports:[f.MD,T,$.G,r.rK.forFeature([c])]})}return o})()},1608:(j,y,s)=>{s.d(y,{L:()=>d});var f=s(3953),r=s(1583),g=s(6582);let d=(()=>{class t{constructor(){this.store=(0,f.WQX)(g.il),this.router=(0,f.WQX)(r.Ix)}canActivate(p,h){const C=this.store.selectSnapshot(u=>u.account).permissions?.map(u=>u?.name),i=p.data?.permission;return!!(!i||!Array.isArray(i)&&C?.includes(i)||Array.isArray(i)&&i?.length&&i.every(u=>C?.includes(u)))||(this.router.navigate(["/error/403"]),!1)}static#t=this.\u0275fac=function(h){return new(h||t)};static#a=this.\u0275prov=f.jDH({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})()}}]);